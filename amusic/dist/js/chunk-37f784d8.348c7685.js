(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37f784d8"],{"872c":function(e,s,t){},9983:function(e,s,t){"use strict";var o=t("a3c2"),n=t.n(o);n.a},a3c2:function(e,s,t){},a55b:function(e,s,t){"use strict";t.r(s);var o=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"login"},[t("van-nav-bar",{attrs:{"left-text":"返回",fixed:"","left-arrow":""},on:{"click-left":e.back}}),t("div",{staticClass:"btn-box"},[t("van-button",{staticClass:"btn registered-btn",attrs:{round:""},on:{click:function(s){return e.goLogin()}}},[e._v("注 册")]),t("van-button",{staticClass:"btn login-btn",attrs:{round:""},on:{click:function(s){return e.goLogin("isLoginPage")}}},[e._v("登 录")])],1),t("van-popup",{style:{height:"70%"},attrs:{position:"bottom",round:"",closeable:""},model:{value:e.isPopup,callback:function(s){e.isPopup=s},expression:"isPopup"}},[e.isLoginPage?t("div",{staticClass:"pop-box"},[t("div",{staticClass:"title"},[e._v("欢迎登录")]),t("div",{staticClass:"content"},[t("van-form",[t("van-field",{attrs:{name:"请输入手机号",label:"手机号",placeholder:"请输入手机号"},model:{value:e.userInfo.userPhone,callback:function(s){e.$set(e.userInfo,"userPhone",s)},expression:"userInfo.userPhone"}}),t("van-field",{attrs:{type:"password",name:"请输入密码",label:"密码",placeholder:"请输入密码"},model:{value:e.userInfo.userPassword,callback:function(s){e.$set(e.userInfo,"userPassword",s)},expression:"userInfo.userPassword"}}),t("div",{staticClass:"pop-btn"},[t("van-button",{attrs:{round:"",block:"",type:"info",color:"#e4393c"},on:{click:e.submit}},[e._v("登 录")])],1)],1)],1)]):t("div",{staticClass:"pop-box"},[t("div",{staticClass:"title"},[e._v("欢迎注册")]),t("div",{staticClass:"content"},[t("van-form",[t("van-field",{attrs:{name:"请输入手机号",label:"手机号",placeholder:"请输入手机号"},model:{value:e.userInfo.userPhone,callback:function(s){e.$set(e.userInfo,"userPhone",s)},expression:"userInfo.userPhone"}}),t("van-field",{attrs:{type:"password",name:"请输入密码",label:"密码",placeholder:"请输入密码"},model:{value:e.userInfo.userPassword,callback:function(s){e.$set(e.userInfo,"userPassword",s)},expression:"userInfo.userPassword"}}),t("van-field",{attrs:{name:"请输入昵称",label:"昵称",placeholder:"请输入昵称"},model:{value:e.userInfo.nickName,callback:function(s){e.$set(e.userInfo,"nickName",s)},expression:"userInfo.nickName"}}),t("van-field",{attrs:{name:"请输入验证码",label:"验证码",placeholder:"请输入验证码"},scopedSlots:e._u([{key:"button",fn:function(){return[t("van-button",{attrs:{size:"small",disabled:e.isSend},on:{click:e.sendVcode}},[e._v(e._s(e.text))])]},proxy:!0}]),model:{value:e.userInfo.vCode,callback:function(s){e.$set(e.userInfo,"vCode",s)},expression:"userInfo.vCode"}}),t("div",{staticClass:"pop-btn"},[t("van-button",{attrs:{round:"",block:"",type:"info",color:"#e4393c"},on:{click:e.submit_}},[e._v("注 册")])],1)],1)],1)])])],1)},n=[],a=(t("68ef"),t("a71a"),t("9d70"),t("3743"),t("4d75"),t("872c"),t("c31d")),r=t("2b0e"),i=t("2638"),l=t.n(i),u=t("d282"),c=t("ba31"),d=t("6605"),p=t("e41f"),f=Object(u["a"])("notify"),h=f[0],g=f[1];function v(e,s,t,o){var n={color:s.color,background:s.background};return e(p["a"],l()([{attrs:{value:s.value,position:"top",overlay:!1,duration:.2,lockScroll:!1},style:n,class:[g([s.type]),s.className]},Object(c["b"])(o,!0)]),[(null==t.default?void 0:t.default())||s.message])}v.props=Object(a["a"])({},d["b"],{color:String,message:[Number,String],duration:[Number,String],className:null,background:String,getContainer:[String,Function],type:{type:String,default:"danger"}});var b,m,k=h(v),I=t("a142");function P(e){return Object(I["e"])(e)?e:{message:e}}function C(e){if(!I["g"])return m||(m=Object(c["c"])(k,{on:{click:function(e){m.onClick&&m.onClick(e)},close:function(){m.onClose&&m.onClose()},opened:function(){m.onOpened&&m.onOpened()}}})),e=Object(a["a"])({},C.currentOptions,P(e)),Object(a["a"])(m,e),clearTimeout(b),e.duration&&e.duration>0&&(b=setTimeout(C.clear,e.duration)),m}function w(){return{type:"danger",value:!0,message:"",color:void 0,background:void 0,duration:3e3,className:"",onClose:null,onClick:null,onOpened:null}}C.clear=function(){m&&(m.value=!1)},C.currentOptions=w(),C.setDefaultOptions=function(e){Object(a["a"])(C.currentOptions,e)},C.resetDefaultOptions=function(){C.currentOptions=w()},C.install=function(){r["a"].use(k)},C.Component=k,r["a"].prototype.$notify=C;var $=C;r["a"].use($);class y{valid(e){for(let s in e)if(!e[s].reg.test(e[s].value))return $({type:"warning",message:e[s].errorMsg}),!1;return!0}}const x=new y;var O=t("2f14"),_={data(){return{isPopup:!1,isLoginPage:!1,isSend:!1,text:"发送验证码",userInfo:{userPhone:"",userPassword:"",nickName:"",vCode:""}}},methods:{back(){this.$router.push({name:"Recommended"})},goLogin(e){void 0!=e?this[e]=!0:this.isLoginPage=!1,this.isPopup=!0},submit(){let e={phone:{reg:/^1[3-9]\d{9}$/,errorMsg:"手机号码格式错误",value:this.userInfo.userPhone}};x.valid(e)&&(this.$toast.loading({type:"loading",message:"加载中",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({methods:"get",url:"/login/cellphone",params:{phone:this.userInfo.userPhone,password:this.userInfo.userPassword}}).then(e=>{this.$toast.clear(),200==e.data.code?(this.$toast.success({duration:1e3,message:"登陆成功"}),O["a"].getCookie("wyyc")&&O["a"].getCookie("uid")||(document.cookie="wyyc="+e.data.cookie,document.cookie="uid="+e.data.profile.userId),this.userInfo.userPhone="",this.userInfo.userPassword="",this.isPopup=!1,this.$store.commit("setUserInfo",e.data.profile),this.back()):this.$toast.fail({duration:1e3,message:e.data.msg})}).catch(e=>{this.$toast.clear(),console.log("err ==> ",e)}))},submit_(){let e={phone:{reg:/^1[3-9]\d{9}$/,errorMsg:"手机号码格式错误",value:this.userInfo.userPhone},password:{value:this.userInfo.userPassword,reg:/^[A-Za-z]\w{5,15}$/,errorMsg:"密码格式不正确，请以字母开头，包含大小写字母，且5-15位"},vCode:{value:this.userInfo.vCode,reg:/([0-9]{4})/,errorMsg:"四位数字的验证码格式不正确"}};x.valid(e)&&null!=this.userInfo.nickName&&(this.$toast.loading({type:"loading",message:"加载中",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({methods:"get",url:"/register/cellphone",params:{phone:this.userInfo.userPhone,password:this.userInfo.userPassword,captcha:this.userInfo.vCode,nickname:this.userInfo.nickName}}).then(e=>{this.$toast.clear()}).catch(e=>{this.$toast.clear(),console.log("err ==> ",e)}))},sendVcode(){this.isSend=!0;let e=60,s=window.setInterval(()=>{e--,this.text="请在"+e+"秒后重送",e<0&&(window.clearInterval(s),this.isSend=!1,this.text="请输入验证码")},1e3),t={phone:{reg:/^1[3-9]\d{9}$/,errorMsg:"手机号码格式错误或不能为空",value:this.userInfo.userPhone}};x.valid(t)&&(this.$toast.loading({type:"loading",message:"发送中",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({methods:"get",url:"/cellphone/existence/check",params:{phone:this.userInfo.userPhone}}).then(e=>{this.$toast.clear(),1!=e.data.exist?-1==e.data.exist&&(this.$toast.loading({type:"loading",message:"发送中",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({methods:"get",url:"/captcha/sent",params:{phone:this.userInfo.userPhone}}).then(e=>{this.$toast.clear(),200==e.data.code&&this.$toast.success({duration:1e3,message:"验证码已成功发送"})}).catch(e=>{this.$toast.clear(),console.log("err ==> ",e)})):this.$toast.fail({duration:1e3,message:"该手机号已经被注册"})}).catch(e=>{this.$toast.clear(),console.log("err ==> ",e)}))}}},S=_,N=(t("9983"),t("2877")),j=Object(N["a"])(S,o,n,!1,null,"2c046fb6",null);s["default"]=j.exports}}]);
//# sourceMappingURL=chunk-37f784d8.348c7685.js.map