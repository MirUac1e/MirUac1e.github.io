{"version":3,"sources":["webpack:///./src/assets/js/utils.js","webpack:///./src/views/mainViews/My.vue?38e4","webpack:///src/views/mainViews/My.vue","webpack:///./src/views/mainViews/My.vue?6dbb","webpack:///./src/views/mainViews/My.vue","webpack:///./src/views/mainViews/My.vue?a75f"],"names":["Utils","queryString","o","params","key","slice","utils","render","_vm","this","_h","$createElement","_c","_self","staticClass","style","backgroundImage","userInfo","attrs","upload","_e","userImg","_v","_s","nickName","desc","_l","item","index","title","to","staticRenderFns","lists","isLogin","maxSize","getUserInfo","methods","tokenString","localStorage","getItem","$router","push","$toast","message","forbidClick","duration","loadingType","axios","method","url","appkey","file","type","split","imgTypes","indexOf","$notify","join","color","background","size","base64","content","replace","data","imgType","serverBase64Img","loading","component"],"mappings":"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","file":"js/chunk-44d673b7.7d226551.js","sourcesContent":["class Utils {\r\n\r\n    //序列化参数\r\n    queryString(o) {\r\n      let params = '';\r\n      for (let key in o) {\r\n        params += `${key}=${o[key]}&`;\r\n      }\r\n  \r\n      return params.slice(0, -1);\r\n    }\r\n  \r\n  }\r\n  \r\n  export const utils = new Utils();","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"my\"},[_c('div',{staticClass:\"my-bg\",style:({ backgroundImage: (\"url(\" + (_vm.userInfo.userBg) + \")\") })},[(_vm.isLogin)?_c('van-uploader',{staticClass:\"uploader-box\",attrs:{\"after-read\":_vm.upload}}):_vm._e()],1),_c('div',{staticClass:\"my-content\"},[_c('div',{staticClass:\"my-box\"},[(_vm.isLogin)?_c('div',[_c('div',{staticClass:\"my-img clearfix\"},[_c('div',{staticClass:\"fl img-box\"},[_c('img',{staticClass:\"auto-img\",attrs:{\"src\":_vm.userInfo.userImg,\"alt\":\"\"}})]),_c('div',{staticClass:\"fl img-text\"},[_c('div',{staticClass:\"nickname\"},[_vm._v(_vm._s(_vm.userInfo.nickName))]),_c('div',{staticClass:\"desc\"},[_vm._v(\" \"+_vm._s(_vm.userInfo.desc == \"\" ? \"这家伙很懒，什么都没留下\" : _vm.userInfo.desc)+\" \")])])])]):_c('div',[_c('van-button',{attrs:{\"type\":\"default\",\"round\":\"\",\"block\":\"\",\"color\":\"#0c34ba\",\"to\":\"Login\"}},[_vm._v(\"请 先 登 录\")])],1),_vm._l((_vm.lists),function(item,index){return _c('div',{key:index,staticClass:\"lists\"},[_c('van-cell',{attrs:{\"title\":item.title,\"to\":item.to,\"is-link\":\"\",\"size\":\"large\"}})],1)})],2)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"my\">\r\n    <!-- 背景 -->\r\n    <div class=\"my-bg\" :style=\"{ backgroundImage: `url(${userInfo.userBg})` }\">\r\n      <van-uploader v-if=\"isLogin\" class=\"uploader-box\" :after-read=\"upload\" />\r\n    </div>\r\n    <!-- 内容 -->\r\n    <div class=\"my-content\">\r\n      <div class=\"my-box\">\r\n        <!-- 基本信息 没有登录的时候隐藏 -->\r\n        <div v-if=\"isLogin\">\r\n          <div class=\"my-img clearfix\">\r\n            <div class=\"fl img-box\">\r\n              <img :src=\"userInfo.userImg\" class=\"auto-img\" alt=\"\" />\r\n            </div>\r\n            <div class=\"fl img-text\">\r\n              <div class=\"nickname\">{{ userInfo.nickName }}</div>\r\n              <div class=\"desc\">\r\n                {{\r\n                  userInfo.desc == \"\"\r\n                    ? \"这家伙很懒，什么都没留下\"\r\n                    : userInfo.desc\r\n                }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div v-else>\r\n          <van-button type=\"default\" round block color=\"#0c34ba\" to=\"Login\"\r\n            >请 先 登 录</van-button\r\n          >\r\n        </div>\r\n        <!-- 个人资料 -->\r\n        <div class=\"lists\" v-for=\"(item, index) in lists\" :key=\"index\">\r\n          <van-cell :title=\"item.title\" :to=\"item.to\" is-link size=\"large\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { utils } from \"../../assets/js/utils\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      lists: [\r\n        {\r\n          title: \"个人资料\",\r\n          to: {\r\n            name: \"Account\",\r\n          },\r\n        },\r\n        {\r\n          title: \"我的订单\",\r\n          to: {\r\n            name: \"Order\",\r\n          },\r\n        },\r\n        {\r\n          title: \"我的收藏\",\r\n          to: {\r\n            name: \"Like\",\r\n          },\r\n        },\r\n        {\r\n          title: \"收货地址\",\r\n          to: {\r\n            name: \"Address\",\r\n          },\r\n        },\r\n        {\r\n          title: \"安全中心\",\r\n          to: {\r\n            name: \"Secure\",\r\n          },\r\n        },\r\n      ],\r\n      isLogin: false,\r\n      userInfo: {},\r\n      maxSize: 1 * 1024 * 1024,\r\n    };\r\n  },\r\n  created() {\r\n    this.getUserInfo();\r\n  },\r\n  methods: {\r\n    // 判断有没有登录,获取用户信息\r\n    getUserInfo() {\r\n      let tokenString = localStorage.getItem(\"CSTK\");\r\n      if (!tokenString) {\r\n        this.isLogin = false;\r\n        return this.$router.push({ name: \"Login\" });\r\n      }\r\n      this.$toast({\r\n        message: \"加载中\",\r\n        forbidClick: true,\r\n        duration: 0,\r\n        loadingType: \"spinner\",\r\n      });\r\n      this.axios({\r\n        method: \"get\",\r\n        url: \"/findMy\",\r\n        params: {\r\n          appkey: this.appkey,\r\n          tokenString,\r\n        },\r\n      })\r\n        .then((result) => {\r\n          this.$toast.clear();\r\n          // console.log(result);\r\n          if ((result.data.code = \"A001\")) {\r\n            if (result.data.result.length == 1) {\r\n              this.userInfo = result.data.result[0];\r\n              this.isLogin = true;\r\n            } else {\r\n              this.isLogin = false;\r\n            }\r\n          }\r\n          // console.log(this.userInfo);\r\n        })\r\n        .catch((err) => {\r\n          console.log(\"error => \", err);\r\n        });\r\n    },\r\n    // 上传背景 修改用户背景\r\n    upload(file) {\r\n      //获取token字符串\r\n      let tokenString = localStorage.getItem(\"CSTK\");\r\n      if (!tokenString) {\r\n        return;\r\n      }\r\n      // 获取文件类型\r\n      let type = file.file.type.split(\"/\")[1];\r\n      let imgTypes = [\"png\", \"gif\", \"jpg\", \"jpeg\"];\r\n      if (imgTypes.indexOf(type) === -1) {\r\n        this.$notify({\r\n          message: \"图片类型只支持\" + imgTypes.join(\",\"),\r\n          color: \"#fff\",\r\n          background: \"#0C34BA\",\r\n        });\r\n\r\n        return;\r\n      }\r\n\r\n      //大小\r\n      if (this.maxSize < file.file.size) {\r\n        this.$notify({\r\n          message: \"上传文件大小不能超过\" + this.maxSize / 1024 + \"KB\",\r\n          color: \"#fff\",\r\n          background: \"#0C34BA\",\r\n        });\r\n        return;\r\n      }\r\n      //获取base64\r\n      let base64 = file.content.replace(/data:image\\/[A-Za-z]+;base64,/, \"\");\r\n      // 参数序列化\r\n      let data = utils.queryString({\r\n        appkey: this.appkey,\r\n        tokenString,\r\n        imgType: type,\r\n        serverBase64Img: base64,\r\n      });\r\n\r\n      this.$toast.loading({\r\n        message: \"加载中...\",\r\n        forbidClick: true,\r\n        duration: 0,\r\n        loadingType: \"spinner\",\r\n      });\r\n\r\n      this.axios({\r\n        method: \"POST\",\r\n        url: \"/updateUserBg\",\r\n        data,\r\n      })\r\n        .then((result) => {\r\n          this.$toast.clear();\r\n          console.log(\"result ==> \", result);\r\n          if (result.data.code == \"I001\") {\r\n            this.userInfo.userBg = result.data.userBg;\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          this.$toast.clear();\r\n          console.log(\"err ==> \", err);\r\n        });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.my {\r\n  // 背景图片\r\n  .my-bg {\r\n    background-color: aqua;\r\n    background-size: cover;\r\n    background-repeat: no-repeat;\r\n    background-position: center center;\r\n    height: 200px;\r\n    overflow: hidden;\r\n    border-bottom-left-radius: 30px;\r\n    border-bottom-right-radius: 30px;\r\n    .uploader-box {\r\n      opacity: 0;\r\n    }\r\n    .uploader-box,\r\n    /deep/ .van-uploader__wrapper {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n\r\n    /deep/ .van-uploader__upload {\r\n      width: 100%;\r\n      height: 100%;\r\n      margin: 0;\r\n    }\r\n    /deep/ .van-uploader__input {\r\n      display: block;\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n  .my-content {\r\n    padding: 0 30px;\r\n    position: relative;\r\n    top: -50px;\r\n    //   background-color: red;\r\n    .my-box {\r\n      // height: 300px;\r\n      padding: 10px;\r\n      background-color: #fff;\r\n      border-radius: 10px;\r\n      // 基本资料\r\n      .my-img {\r\n        .img-box {\r\n          width: 80px;\r\n          height: 80px;\r\n          border-radius: 50%;\r\n          overflow: hidden;\r\n          margin-right: 20px;\r\n          background-color: aqua;\r\n        }\r\n        .img-text {\r\n          width: calc(~\"100% - 100px\");\r\n          .nickname {\r\n            height: 40px;\r\n            font-size: 16px;\r\n            line-height: 40px;\r\n            color: #0c34ba;\r\n            font-weight: bold;\r\n          }\r\n          .desc {\r\n            font-size: 14px;\r\n            color: #999;\r\n            // 两行溢出隐藏\r\n            -webkit-line-clamp: 2;\r\n            display: -webkit-box;\r\n            -webkit-box-orient: vertical;\r\n            overflow: hidden;\r\n          }\r\n        }\r\n      }\r\n      // list\r\n      .lists {\r\n        margin-top: 10px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./My.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./My.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./My.vue?vue&type=template&id=8f93bf42&scoped=true&\"\nimport script from \"./My.vue?vue&type=script&lang=js&\"\nexport * from \"./My.vue?vue&type=script&lang=js&\"\nimport style0 from \"./My.vue?vue&type=style&index=0&id=8f93bf42&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8f93bf42\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./My.vue?vue&type=style&index=0&id=8f93bf42&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./My.vue?vue&type=style&index=0&id=8f93bf42&lang=less&scoped=true&\""],"sourceRoot":""}