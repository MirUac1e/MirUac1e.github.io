(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2acfd6fc"],{"2f14":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));class s{queryString(t){let e="";for(let a in t)e+=`${a}=${t[a]}&`;return e.slice(0,-1)}}const i=new s},3894:function(t,e,a){"use strict";var s=a("b3b1"),i=a.n(s);i.a},"77be":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"account"},[a("van-nav-bar",{attrs:{title:"个人资料","left-text":"返回","left-arrow":"",fixed:!0},on:{"click-left":t.back}}),a("div",{staticClass:"list-box"},[a("van-cell",{attrs:{title:"头像"}},[a("div",{staticClass:"avatar fr"},[a("img",{staticClass:"auto-img",attrs:{src:t.userInfo.userImg,alt:""}}),a("van-uploader",{staticClass:"uploader-box",attrs:{"after-read":t.uploadUserImg}})],1)]),a("van-cell",{attrs:{title:"用户id"}},[a("div",{staticClass:"fr"},[t._v(" "+t._s(t.userInfo.userId)+" ")])]),a("van-cell",{attrs:{title:"手机号"}},[a("div",{staticClass:"fr"},[t._v(" "+t._s(t.userInfo.phone)+" ")])]),a("van-cell",{attrs:{title:"昵称"}},[a("div",{staticClass:"fr"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.userInfo.nickName,expression:"userInfo.nickName"}],staticClass:"nickname",attrs:{type:"text"},domProps:{value:t.userInfo.nickName},on:{change:function(e){return t.modifyUserInfo("nickName","updateNickName")},input:function(e){e.target.composing||t.$set(t.userInfo,"nickName",e.target.value)}}})])]),a("div",{staticClass:"desc-box"},[a("div",{staticClass:"desc-title"},[t._v("简介")]),a("div",{staticClass:"desc-content"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.userInfo.desc,expression:"userInfo.desc"}],staticClass:"desc-text-area",attrs:{placeholder:"这家伙很懒，什么都没有留下"},domProps:{value:t.userInfo.desc},on:{change:function(e){return t.modifyUserInfo("desc","updateDesc")},input:function(e){e.target.composing||t.$set(t.userInfo,"desc",e.target.value)}}})])])],1)],1)},i=[],o=a("2f14"),r={data(){return{userInfo:{},maxSize:1048576}},created(){this.getUserInfo()},methods:{back(){this.$router.go(-1)},getUserInfo(){let t=localStorage.getItem("CSTK");if(!t)return this.isLogin=!1,this.$router.push({name:"Login"});this.$toast({message:"加载中",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"get",url:"/findAccountInfo",params:{appkey:this.appkey,tokenString:t}}).then(t=>{this.$toast.clear(),"B001"==t.data.code&&(this.userInfo=t.data.result[0])}).catch(t=>{console.log("error => ",t)})},uploadUserImg(t){let e=localStorage.getItem("CSTK");if(!e)return;let a=t.file.type.split("/")[1],s=["png","gif","jpg","jpeg"];if(-1===s.indexOf(a))return void this.$notify({message:"图片类型只支持"+s.join(","),color:"#fff",background:"#0C34BA"});if(this.maxSize<t.file.size)return void this.$notify({message:"上传文件大小不能超过"+this.maxSize/1024+"KB",color:"#fff",background:"#0C34BA"});let i=t.content.replace(/data:image\/[A-Za-z]+;base64,/,""),r=o["a"].queryString({appkey:this.appkey,tokenString:e,imgType:a,serverBase64Img:i});this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"POST",url:"/updateAvatar",data:r}).then(t=>{this.$toast.clear(),"H001"==t.data.code&&(this.userInfo.userImg=t.data.userImg,this.$toast(t.data.msg))}).catch(t=>{this.$toast.clear(),console.log("err ==> ",t)})},modifyNickName(){let t=localStorage.getItem("CSTK");if(!t)return;let e=o["a"].queryString({appkey:this.appkey,tokenString:t,nickName:this.userInfo.nickName});this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"POST",url:"/updateNickName",data:e}).then(t=>{this.$toast.clear(),console.log(t),"C001"==t.data.code&&this.$toast(t.data.msg)}).catch(t=>{this.$toast.clear(),console.log("err ==> ",t)})},modifyDesc(){},modifyUserInfo(t,e){let a=localStorage.getItem("CSTK");if(!a)return;let s=o["a"].queryString({appkey:this.appkey,tokenString:a,[t]:this.userInfo[t]});this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"POST",url:e,data:s}).then(t=>{this.$toast.clear(),this.$toast(t.data.msg)}).catch(t=>{this.$toast.clear(),console.log("err ==> ",t)})}}},n=r,c=(a("3894"),a("2877")),l=Object(c["a"])(n,s,i,!1,null,"7bcc6198",null);e["default"]=l.exports},b3b1:function(t,e,a){}}]);
//# sourceMappingURL=chunk-2acfd6fc.f42e5cfd.js.map